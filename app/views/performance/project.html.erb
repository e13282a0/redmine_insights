<% content_for :header_tags do %>


	



	<%= javascript_include_tag "includes/echarts.min.js",:plugin => 'redmine_insights'%>
	<%= javascript_include_tag "includes/moment.min.js", :plugin => 'redmine_insights'%>
	<%= javascript_include_tag "includes/insights.js", :plugin => 'redmine_insights'%>
<% end %>

<h2>PerformanceController#project</h2>

<div id="app">
  <v-app>
      <v-main>
  		<button-counter></button-counter>

		<is-chart />
     </v-main>
</v-app>
</div>

<div id="hoursPerTopLevelTaskChart" style="width: 100%;height:350px;"></div>
<div id="avgHoursPerTopLevelTaskChart" style="width: 100%;height:350px;"></div>
<div id="sumHoursPerTopLevelTaskChart" style="width: 100%;height:350px;"></div>
<div id="treemap" style="width: 100%;height:500px;"></div>
<div id="userRadarChart" style="width: 100%;height:500px;"></div>


<hr />


<!-- install vue, vuetify and vue-echart -->
<%= javascript_include_tag "https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js","https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js","https://cdn.jsdelivr.net/npm/http-vue-loader@1.4.2/src/httpVueLoader.min.js"%>
<%= stylesheet_link_tag "https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900", "https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css","https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" %>
<%= javascript_include_tag "https://cdn.jsdelivr.net/npm/@vue/composition-api@1.0.5","https://cdn.jsdelivr.net/npm/vue-echarts@6.0.0"%>

<script type="text/javascript">
	Vue.component("v-chart", VueECharts);
	var app = new Vue({
		el: '#app',
		components: {
			'is-chart':httpVueLoader('/plugin_assets/redmine_insights/javascripts/components/is-chart.vue')
			},
		data: {
			timeEntries: JSON.parse('<%= @time_entries.to_json.html_safe() %>'),
			issues: JSON.parse('<%= @issues.to_json.html_safe() %>'),
			user: JSON.parse('<%= @users.to_json.html_safe() %>'),
			versions: JSON.parse('<%= @versions.to_json.html_safe() %>')
		},
		vuetify: new Vuetify(),
		methods: {
			reverseMessage: function () {
				this.message = this.message.split('').reverse().join('')
			}
		}
		
	})


//   const timeSeriesData = getTimeSeriesData(timeEntries, issues, versions);
// 	const hoursPerTopLevelTaskChart = echarts.init(document.getElementById('hoursPerTopLevelTaskChart'));
// 	hoursPerTopLevelTaskChart.setOption(weeklyHours(timeSeriesData));
//   const avgHoursPerTopLevelTaskChart = echarts.init(document.getElementById('avgHoursPerTopLevelTaskChart'));
// 	avgHoursPerTopLevelTaskChart.setOption(avgWeeklyHours(timeSeriesData));
//   const sumHoursPerTopLevelTaskChart = echarts.init(document.getElementById('sumHoursPerTopLevelTaskChart'));
// 	sumHoursPerTopLevelTaskChart.setOption(weeklyHoursSummed(timeSeriesData));

//   const treeMapData = getTreeMapData(issues);
//   const treemap = echarts.init(document.getElementById('treemap'));
//   treemap.setOption(treeMap(treeMapData));

//   const userRadarData = getUserRadarData(timeEntries, issues, users);
//   const userRadarChart = echarts.init(document.getElementById('userRadarChart'));
//   userRadarChart.setOption(getUserRadarChart(userRadarData));
	
</script>
	

<%= javascript_include_tag "app.js", :plugin => 'redmine_insights'%>
